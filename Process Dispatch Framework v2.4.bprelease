<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>Process Dispatch Framework v2.4</bpr:name>
    <bpr:release-notes>2020/01/21 - Removed the IBM BAW example from the Template - Process Callback VBO. If people weren't dealing with IBM, this was throwing errors due to the lack of the IBM skills. The IBM example now resides in a seaparate VBO that can replace the Template VBO.</bpr:release-notes>
    <bpr:created>2020-01-21 13:04:19Z</bpr:created>
    <bpr:package-id>49</bpr:package-id>
    <bpr:package-name>Process Dispatch Framework</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="9">
        <process id="102f1e61-4ecb-44be-bb03-ce074a2012f5" name="Dispatched Process Monitor" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Dispatched Process Monitor" version="1.0" bpversion="6.5.1.14401" narrative="This process is responsible for periodically checking the status of processes that were dispatched, asynchronously, from the Process Dispatcher utility. This process will check to see if any of the processes have completed. If they have, this process will invoke a generic VBO that can be used to perform a &quot;callback&quot; to the original caller.&#xD;&#xA;&#xD;&#xA;TIP: This process should be set to run on a schedule (ex. every 5 minutes).&#xD;&#xA;&#xD;&#xA;Version: 2.4" byrefcollection="true"><view><camerax>0</camerax><cameray>210</cameray><zoom version="2">1.25</zoom></view><preconditions><condition narrative="The work queue 'Dispatched Processes' must exist in the Blue Prism environment." /></preconditions><endpoint narrative="" /><subsheet subsheetid="ede05cbf-652e-4e20-b8fb-d616a6329d83" type="Normal" published="False"><name>Get Process Results</name><view><camerax>0</camerax><cameray>21</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="8160200d-1136-4333-8a49-374c89d4a71b" name="Start" type="Start"><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>73020cec-a012-420a-b2ee-50b2785e987d</onsuccess></stage><stage stageid="c8ecd03d-df4f-420c-887a-c355e947c569" name="End" type="End"><narrative></narrative><displayx>105</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="5e162635-46a4-4544-8639-e8ac69f7ef13" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-225</displayx><displayy>-90</displayy><displaywidth>240</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="73020cec-a012-420a-b2ee-50b2785e987d" name="Get Item" type="Action"><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue" expr="[Queue: Dispatched Processes]" /><input type="text" name="Key Filter" friendlyname="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" friendlyname="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" /></inputs><outputs><output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="Data" /><output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="Status" /><output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="Attempts" /></outputs><onsuccess>b83bb7a2-1146-438e-ba45-358e44ce30f7</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="1aac1685-ca8f-469b-aa62-bd3aa2e46af5" name="Queue: Dispatched Processes" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Dispatched Processes</initialvalue><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="535fc54c-6027-43fb-b34b-c1a87d538317" name="Local Variables" type="Block"><narrative></narrative><displayx>-315</displayx><displayy>0</displayy><displaywidth>180</displaywidth><displayheight>390</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="887f5917-c78c-4356-a185-0bc9fd4dde81" name="Item ID" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4a3044c8-615d-429a-9289-97ab2e46f688" name="Data" type="Collection"><narrative></narrative><displayx>-225</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="SessionID" type="text" /><field name="ProcessName" type="text" /><field name="CallbackInfo" type="text" /></collectioninfo></stage><stage stageid="8c3e247c-20ba-4a8a-8f29-93aa70f2ee04" name="Status" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="79fb8177-d13a-46e8-af62-ef75f2fe4f9b" name="Attempts" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b83bb7a2-1146-438e-ba45-358e44ce30f7" name="Got Item?" type="Decision"><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Item ID]&lt;&gt;&quot;&quot;" /><ontrue>2d5e9502-1a58-468a-8578-bdd68bf5979b</ontrue><onfalse>c8ecd03d-df4f-420c-887a-c355e947c569</onfalse></stage><stage stageid="2d5e9502-1a58-468a-8578-bdd68bf5979b" name="Check Process Status" type="Action"><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SessionID" friendlyname="SessionID" narrative="The unique ID of a process session." expr="[Data.SessionID]" /><input type="flag" name="UseSSO" friendlyname="UseSSO" narrative="A flag indicating whether single sign-on should be used." expr="False" /><input type="text" name="Credential Name" friendlyname="Credential Name" narrative="The name of a credential within the Blue Prism Credential Manager to use if not using SSO." expr="[Process Dispatcher Credential Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" stage="Success" /><output type="text" name="Process Status" friendlyname="Process Status" stage="Process Status" /><output type="text" name="Output" friendlyname="Output" stage="Output" /></outputs><onsuccess>dda22bdd-407f-4948-8bfa-1bbc427c00d3</onsuccess><resource object="Utility - Process Dispatcher" action="Get Process Status" /></stage><stage stageid="77b609ef-e793-4c06-80a7-f0e82ea8cb39" name="Process Dispatcher Credential Name" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="27164224-231b-4b50-a009-2ce05c92df46" name="Success" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7d11e59e-d377-44c6-87a4-4029af79b883" name="Process Status" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>240</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="54ab3b09-9e94-4a42-80d4-7c31594fcdb1" name="Output" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>270</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dda22bdd-407f-4948-8bfa-1bbc427c00d3" name="Completed?" type="Decision"><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Upper(Trim([Process Status])) = &quot;COMPLETED&quot;" /><ontrue>f3f04ad5-53a4-405a-97cd-847f42c2a01a</ontrue><onfalse>8392abfd-34ea-4c2d-99b0-c822dbeed890</onfalse></stage><stage stageid="9557730b-04a2-43b1-85f8-3b49e668cbf4" name="Mark Complete" type="Action"><loginhibit onsuccess="true" /><narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><displayx>15</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /></inputs><onsuccess>5f95bb13-3ad5-49ac-bded-bc280fc421fe</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" /></stage><stage stageid="5f95bb13-3ad5-49ac-bded-bc280fc421fe" name="Anchor1" type="Anchor"><narrative></narrative><displayx>-60</displayx><displayy>270</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>44956787-d09e-44eb-94d2-e064e4267267</onsuccess></stage><stage stageid="44956787-d09e-44eb-94d2-e064e4267267" name="Anchor2" type="Anchor"><narrative></narrative><displayx>-60</displayx><displayy>-60</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>73020cec-a012-420a-b2ee-50b2785e987d</onsuccess></stage><stage stageid="8392abfd-34ea-4c2d-99b0-c822dbeed890" name="Defer" type="Action"><loginhibit onsuccess="true" /><narrative>Marks the item as deferred. It is unlocked, but it will not be made available for processing again until the specified time.

The attempts count for the item is reset to zero.</narrative><displayx>105</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to defer" expr="[Item ID]" /><input type="datetime" name="Until" friendlyname="Until" narrative="When to resume processing the case" expr="Now() + MakeTimeSpan(0, 0, [Deferal Period], 0)" /></inputs><onsuccess>b9136ab6-1469-4d89-a5d1-fe689c8c72dc</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Defer" /></stage><stage stageid="b9136ab6-1469-4d89-a5d1-fe689c8c72dc" name="Anchor3" type="Anchor"><narrative></narrative><displayx>165</displayx><displayy>75</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>12fdee40-3b59-4d0a-a70c-e4c4f5b33df9</onsuccess></stage><stage stageid="12fdee40-3b59-4d0a-a70c-e4c4f5b33df9" name="Anchor4" type="Anchor"><narrative></narrative><displayx>165</displayx><displayy>-60</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>73020cec-a012-420a-b2ee-50b2785e987d</onsuccess></stage><stage stageid="10c310cb-9f0a-4999-9301-1acceeaecea6" name="Note1" type="Note"><narrative>If the process is not completed, we defer the item in the queue for a period of time. This is necessary to ensure the item is not locked from processing at a later time.</narrative><displayx>405</displayx><displayy>75</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="0000FF" /></stage><stage stageid="d925337f-3aae-4ba9-bfa0-dbefe1c7719d" name="Note2" type="Note"><narrative>If the process has completed, notify the original caller that the process has finished and mark it as complete in the queue. 

In some cases you may chose to change this order. However, by executing the callback before marking the item complete you could potentially catch any exceptions that occur during the callback. If an exception does occur, you could defer the item in queue giving you another opportunity to issue a callback.

NOTE: If you are using a different callback object than the template, you will need to change the reference in the 'Execute Callback" stage.</narrative><displayx>180</displayx><displayy>330</displayy><displaywidth>240</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="0000FF" /></stage><stage stageid="54444a63-c650-4a43-8fc3-d3b878aa7dd0" name="Execute Callback" type="Action"><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>210</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="CallbackInfo" friendlyname="CallbackInfo" narrative="Callback information that was provided during the initial process invocation." expr="[Data.CallbackInfo]" /><input type="text" name="ProcessResults" friendlyname="ProcessResults" narrative="The output from a specific process session instance." expr="[Process Results]" /></inputs><onsuccess>9557730b-04a2-43b1-85f8-3b49e668cbf4</onsuccess><resource object="Template - Process Callback" action="Execute Callback" /></stage><stage stageid="1e2741f2-0794-4b5b-998f-7c3bedc77207" name="Callback" type="Block"><narrative></narrative><displayx>-30</displayx><displayy>180</displayy><displaywidth>180</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="CCFFFF" /></stage><stage stageid="eb14a80c-6069-496f-90b1-bea8ca635e5d" name="Recover2" type="Recover"><narrative></narrative><displayx>105</displayx><displayy>210</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b9e7794a-fdb3-486a-9e5b-f9c07c52674e</onsuccess></stage><stage stageid="6249d294-a476-435a-a9ee-1ca2310c904c" name="Resume1" type="Resume"><narrative></narrative><displayx>270</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e8a208fe-8bad-482b-98a9-cfe2350e6df7</onsuccess></stage><stage stageid="e8a208fe-8bad-482b-98a9-cfe2350e6df7" name="Mark Exception" type="Action"><loginhibit onsuccess="true" /><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><displayx>270</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Details]" /><input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" /><input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="" /></outputs><onsuccess>4a486c78-1fd7-470c-a68f-61f95fa1e1bb</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="907c5892-6bcd-405a-a805-e530ba99f452" name="Exception Details" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>300</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b9e7794a-fdb3-486a-9e5b-f9c07c52674e" name="Get Callback Exception Detail" type="Calculation"><narrative></narrative><displayx>210</displayx><displayy>210</displayy><displaywidth>60</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c4a90935-0596-49b9-ad13-439658032c31</onsuccess><calculation expression="&quot;Callback Exception: &quot; &amp; ExceptionDetail()" stage="Exception Details" /></stage><stage stageid="4a486c78-1fd7-470c-a68f-61f95fa1e1bb" name="Reset Exception Detail" type="Calculation"><narrative></narrative><displayx>270</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>12fdee40-3b59-4d0a-a70c-e4c4f5b33df9</onsuccess><calculation expression="&quot;&quot;" stage="Exception Details" /></stage><stage stageid="cb7a338d-4336-46c1-af04-6d9428eab949" name="Get Process Results" type="SubSheetInfo"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative>This page is used to collect the output results from a completed Blue Prism process.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="6385f958-be3c-457b-b2ea-b508fa90748c" name="Start" type="Start"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><preconditions><condition narrative="You must set the connection values for the Blue Prism database." /></preconditions><narrative></narrative><displayx>15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SessionID" stage="SessionID" /></inputs><onsuccess>3fa9a9ad-c4d9-4d4f-8767-0fd42e741e6a</onsuccess></stage><stage stageid="51f035de-c9b9-4923-ac3a-dc010022bb29" name="End" type="End"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Process Results" stage="Session Output" /></outputs></stage><stage stageid="dbea0c12-21b3-40c3-8817-e29c8a64a36d" name="SessionID" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9bc4d58f-b5e6-43dd-8a9b-4c6028d5618d" name="Input" type="Block"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="20b8149a-2046-4ca3-8c66-a334ebdbfbed" name="Local Values" type="Block"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-270</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="a787cd55-8f34-497b-ac9d-7fb0618a2497" name="DB Server" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="8e53ea0d-eb6c-4aca-8631-8ba32c6491e7" name="DB Name" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="5f916bb2-6605-46b0-8d67-8392d55b1d8e" name="DB Credential Name" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="416501ed-d96b-42ab-bed4-cc4afadd4e16" name="Connection Details Set" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><alwaysinit /></stage><stage stageid="3fa9a9ad-c4d9-4d4f-8767-0fd42e741e6a" name="Set DB Connection Details" type="Action"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Database Server" friendlyname="Database Server" narrative="The hostname and SQL instance of the Blue Prism SQL Server (ex.LOCALHOST\SQLEXPRESS)." expr="[DB Server]" /><input type="text" name="Database Name" friendlyname="Database Name" narrative="The name of the Blue Prism database within the SQL Server instance." expr="[DB Name]" /><input type="text" name="Database Credential Name" friendlyname="Database Credential Name" narrative="The name of the user credential defined in Credential Manager with access rights on the Blue Prism database." expr="[DB Credential Name]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag indicating success or failure of the method." stage="Success" /></outputs><onsuccess>2bd88466-db18-40d7-a6ba-0388fb3ceec7</onsuccess><resource object="Utility - Blue Prism Process Info" action="Set Connection Details" /></stage><stage stageid="94f8dc89-611f-4083-89e8-ff9021787f0f" name="Success" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="2bd88466-db18-40d7-a6ba-0388fb3ceec7" name="Success?" type="Decision"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Success] = True" /><ontrue>ddac23f4-4ae9-47ea-b564-dc529323f679</ontrue><onfalse>b8e927f3-45a1-4026-a782-6865211f82a4</onfalse></stage><stage stageid="ddac23f4-4ae9-47ea-b564-dc529323f679" name="Reset Flag" type="Calculation"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>255c736b-2790-4994-9ea1-1e516f1e8e91</onsuccess><calculation expression="False" stage="Success" /></stage><stage stageid="b8e927f3-45a1-4026-a782-6865211f82a4" name="Anchor1" type="Anchor"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-60</displayx><displayy>0</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>82e460a4-76df-47e0-910d-4cafe7ab4149</onsuccess></stage><stage stageid="255c736b-2790-4994-9ea1-1e516f1e8e91" name="Get Session Output" type="Action"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SessionID" friendlyname="SessionID" expr="[SessionID]" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="A flag indicating the success or failure of the method." stage="Success" /><output type="text" name="Session Output" friendlyname="Session Output" narrative="An XML encoded string containing the output of the session." stage="Session Output" /></outputs><onsuccess>51f035de-c9b9-4923-ac3a-dc010022bb29</onsuccess><resource object="Utility - Blue Prism Process Info" action="Get Session Output" /></stage><stage stageid="4dbb39c7-c891-4b14-a52b-9f33515aef44" name="Session Output" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>285</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="000c5ca2-7147-4b11-ad23-a37ab102a57f" name="Output" type="Block"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-270</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="82e460a4-76df-47e0-910d-4cafe7ab4149" name="Anchor5" type="Anchor"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-60</displayx><displayy>165</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /><onsuccess>51f035de-c9b9-4923-ac3a-dc010022bb29</onsuccess></stage><stage stageid="f3f04ad5-53a4-405a-97cd-847f42c2a01a" name="Get Process Results" type="SubSheet"><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SessionID" friendlyname="SessionID" expr="[Data.SessionID]" /></inputs><outputs><output type="text" name="Process Results" friendlyname="Process Results" stage="Process Results" /></outputs><onsuccess>54444a63-c650-4a43-8fc3-d3b878aa7dd0</onsuccess><processid>ede05cbf-652e-4e20-b8fb-d616a6329d83</processid></stage><stage stageid="db6abe66-cead-4afe-9cc9-b7703377bc54" name="Process Results" type="Data"><narrative></narrative><displayx>-225</displayx><displayy>330</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="efacfffd-2a62-4d76-9589-e968568905a1" name="Note3" type="Note"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative>NOTE

The value of the Success flag is set as output from each of the database calls.</narrative><displayx>150</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="0000FF" /></stage><stage stageid="29d5f628-dbef-445e-943b-e1f0354cab64" name="Note4" type="Note"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative>**NOTE**

Make sure to set the values for:
- DB Server
- DB Name
- DB Credential Name</narrative><displayx>-375</displayx><displayy>105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="12" style="Regular" color="FF0000" /></stage><stage stageid="92dac2b7-1f7d-4bc8-b2d8-e559852f47b6" name="Block1" type="Block"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>-90</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="af9fc461-d9a1-4e1c-94ca-d9ef7681984d" name="Block2" type="Block"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>75</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="CCFFFF" /></stage><stage stageid="972d3fdb-ed3c-427d-a61e-f31fa1a15a7e" name="Recover2" type="Recover"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>376889dd-42dc-42ec-9cb7-3c2b9c0478e3</onsuccess></stage><stage stageid="18ca5ea5-7b3b-46df-a349-2b848ea2c0ad" name="Recover3" type="Recover"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>90</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>01392fa7-e7f8-41fe-b408-ac860d3873db</onsuccess></stage><stage stageid="ce99aed2-fb28-4e30-a94b-46403ee60027" name="Exception Details" type="Data"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="376889dd-42dc-42ec-9cb7-3c2b9c0478e3" name="Set Exception Details" type="Calculation"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>180</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>a3eb9a77-d21f-4f43-9a4c-0472ea540f17</onsuccess><calculation expression="&quot;The following exception was encountered while setting the database connection details: &quot; &amp; ExceptionDetail()" stage="Exception Details" /></stage><stage stageid="a3eb9a77-d21f-4f43-9a4c-0472ea540f17" name="Resume2" type="Resume"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1cb682a7-8524-4229-aa8f-5e4d3cee4976</onsuccess></stage><stage stageid="1cb682a7-8524-4229-aa8f-5e4d3cee4976" name="DB Connection Exception" type="Exception"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>330</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception localized="yes" type="System Exception" detail="[Exception Details]" /></stage><stage stageid="01392fa7-e7f8-41fe-b408-ac860d3873db" name="Set Exception Details" type="Calculation"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>180</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b23737ee-af4a-43ae-bbb1-eb5e61e9640a</onsuccess><calculation expression="&quot;The following exception was encountered while retrieving the session output: &quot; &amp; ExceptionDetail()" stage="Exception Details" /></stage><stage stageid="b23737ee-af4a-43ae-bbb1-eb5e61e9640a" name="Resume2" type="Resume"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>255</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b4d65a5f-1005-43f9-a840-8a11f925b363</onsuccess></stage><stage stageid="b4d65a5f-1005-43f9-a840-8a11f925b363" name="Session Output Exception" type="Exception"><subsheetid>ede05cbf-652e-4e20-b8fb-d616a6329d83</subsheetid><narrative></narrative><displayx>330</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception localized="yes" type="System Exception" detail="[Exception Details]" /></stage><stage stageid="86691fa7-965d-475d-a863-c3e471237f25" name="Deferal Period" type="Data"><narrative>The number of minutes to defer an item for before it can be checked again.</narrative><displayx>-225</displayx><displayy>360</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>10</initialvalue><private /><alwaysinit /></stage><stage stageid="c43ad41d-234b-4e16-93c3-4e29edeb3a01" name="Process Results" type="Block"><narrative></narrative><displayx>-30</displayx><displayy>105</displayy><displaywidth>180</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFCC99" /></stage><stage stageid="e203f55e-3208-4338-be70-5a90d3f63fb6" name="Recover1" type="Recover"><narrative></narrative><displayx>105</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>8ca682ce-0c2c-42fd-9216-8401b602b6bd</onsuccess></stage><stage stageid="8ca682ce-0c2c-42fd-9216-8401b602b6bd" name="Get Result Exception Detail" type="Calculation"><narrative></narrative><displayx>210</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c4b03d5b-74d5-4dc1-b632-9cebff8fc991</onsuccess><calculation expression="&quot;Process Results Exception: &quot; &amp; ExceptionDetail()" stage="Exception Details" /></stage><stage stageid="c4b03d5b-74d5-4dc1-b632-9cebff8fc991" name="Anchor6" type="Anchor"><narrative></narrative><displayx>270</displayx><displayy>135</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>6249d294-a476-435a-a9ee-1ca2310c904c</onsuccess></stage><stage stageid="c4a90935-0596-49b9-ad13-439658032c31" name="Anchor7" type="Anchor"><narrative></narrative><displayx>270</displayx><displayy>210</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c4b03d5b-74d5-4dc1-b632-9cebff8fc991</onsuccess></stage></process></process>
        <object id="66af8e92-09a0-4be0-8a98-5c493155875b" name="Template - Process Callback" xmlns="http://www.blueprism.co.uk/product/process"><process name="Template - Process Callback" version="1.0" bpversion="6.5.1.14401" narrative="This is a template VBO that should be customized for your specific callback requirements. &#xD;&#xA;&#xD;&#xA;Version: 2.4" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>b08646bb-3596-4c32-af6f-dbe2a0f10edc</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="eb587ef1-0c89-4d7a-8ad3-c4672f1a6728" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="74cf2f43-443d-4ea8-a4cb-f791c80795fc" type="Normal" published="True"><name>Execute Callback</name><view><camerax>15</camerax><cameray>21</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="3a66ee72-23cc-4028-be3e-4a29538602c1" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f731b65a-27eb-4807-baa5-289aeb6d66ed</onsuccess></stage><stage stageid="f731b65a-27eb-4807-baa5-289aeb6d66ed" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="787622c0-6ed4-4ccc-933d-d858058cddf3" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>System.Core.dll</reference><reference>Newtonsoft.Json.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Xml</import><import>Newtonsoft.Json</import></imports><language>csharp</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[// NOTE: Blue Prism input/output parameters are defined as attributes on Xml
// elements. As such, the names in the Json will be prepended with a "@" 
// character
// Example:
// <outputs>
//    <output name='Param1' type='Text' value='This is a test.' />
// </outputs>
//
// {
//   "outputs": {
//     "output": {
//       "@name": "Param1",
//       "@type": "Text",
//       "@value": "This is a test."
//     }
//   }
// }
string convertXmlToJson(string inputXml)
{
	// Load the input Xml into an XmlDocument instance.
	XmlDocument doc = new XmlDocument();
	doc.LoadXml(inputXml);
	
	// Use Newtonsoft to convert the Xml document to Json.
	return JsonConvert.SerializeXmlNode(doc);	
}]]></code></stage><stage stageid="9a7c7cf6-1ec4-4902-9cf3-f3566601e93b" name="Clean Up" type="SubSheetInfo"><subsheetid>eb587ef1-0c89-4d7a-8ad3-c4672f1a6728</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="0f7f4d33-5977-4396-8e39-137a5256543c" name="Start" type="Start"><subsheetid>eb587ef1-0c89-4d7a-8ad3-c4672f1a6728</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>6ef99b03-f061-49f0-b186-d2b214d6ead2</onsuccess></stage><stage stageid="6ef99b03-f061-49f0-b186-d2b214d6ead2" name="End" type="End"><subsheetid>eb587ef1-0c89-4d7a-8ad3-c4672f1a6728</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="8b939fdb-1ffa-4157-bee2-e42a18782a5f" name="Execute Callback" type="SubSheetInfo"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="82d07fbb-3422-4bd7-a744-78a8a60ba658" name="Start" type="Start"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="CallbackInfo" narrative="Callback information that was provided during the initial process invocation." stage="CallbackInfo" /><input type="text" name="ProcessResults" narrative="The output from a specific process session instance." stage="ProcessResults" /></inputs><onsuccess>82204d5f-5c48-4266-9e2a-20941278e463</onsuccess></stage><stage stageid="82204d5f-5c48-4266-9e2a-20941278e463" name="End" type="End"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="35c96b2b-e313-40bb-92ae-e8edb4c70446" name="Note1" type="Note"><subsheetid>eb587ef1-0c89-4d7a-8ad3-c4672f1a6728</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="c0a5d400-bdfa-47ee-a2a2-43f357264593" name="Note2" type="Note"><narrative>READ ME

This VBO was created as a template that you will customize as part of the Process Dispatch framework.

You should customize this VBO such that implements the specific callback logic necessary to perform a callback to whatever application performed the original invocation of a Blue Prism process.</narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>300</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage><stage stageid="220b4286-31c0-43f8-b3e4-3e2edf642be5" name="Note3" type="Note"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative>NOTE

Customize this method to perform your specific callback.</narrative><displayx>240</displayx><displayy>-135</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage><stage stageid="80cd2319-4bc0-4c8d-a9be-7e0b003b93ff" name="CallbackInfo" type="Data"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="60f01851-d5b6-4a5d-8e57-63ce8719d0b8" name="Input" type="Block"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="63bd7cba-8c77-4d00-8a70-fa713066bb6c" name="ProcessResults" type="Data"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c53b028d-a935-40d3-9f4a-43bf149e7926" name="Note3" type="Note"><subsheetid>74cf2f43-443d-4ea8-a4cb-f791c80795fc</subsheetid><loginhibit /><narrative>NOTE 2

The standard encoding of input/output parameters in Blue Prism is in XML. If you prefer to work in JSON, there is a global method defined in the Initialise tab of this object called convertXmlToJson() that you may use to convert the Blue Prism process output to Json.</narrative><displayx>240</displayx><displayy>-30</displayy><displaywidth>240</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="12" style="Regular" color="0000FF" /></stage></process></object>
        <object id="0c6b4a32-34ee-4848-be38-7bc9196237ef" name="Utility - Process Dispatcher" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - Process Dispatcher" version="1.0" bpversion="6.5.1.14401" narrative="Version: 2.4" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>084f7f4c-7fa9-4d92-8ad7-bfda474c5069</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="849bb75f-cb17-4e0a-8501-5fd66f31eb48" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="fbe99cb3-70e0-4179-8ec5-57b7d41d301c" type="Normal" published="True"><name>Run Process</name><view><camerax>89</camerax><cameray>60</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7e3852b7-ac06-4635-a81b-df7ccf5d8f0f" type="Normal" published="True"><name>Get Process Status</name><view><camerax>0</camerax><cameray>11</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="4c2f82bf-4a85-405f-a143-82d11681fa75" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4882712d-dc54-4804-8932-3d41f6df6e4b</onsuccess></stage><stage stageid="4882712d-dc54-4804-8932-3d41f6df6e4b" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="3df17157-527f-4cc0-a248-6898d0000789" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>Newtonsoft.Json.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.Xml</import><import>Newtonsoft.Json</import><import>System.Net</import></imports><language>csharp</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="208c6242-2c90-4b96-94c2-0a47b2439567" name="Clean Up" type="SubSheetInfo"><subsheetid>849bb75f-cb17-4e0a-8501-5fd66f31eb48</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="c292faac-7830-43eb-afd3-56d5ffedde32" name="Start" type="Start"><subsheetid>849bb75f-cb17-4e0a-8501-5fd66f31eb48</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>f99d85f0-bee3-45f0-84cb-dfe7c5cc3833</onsuccess></stage><stage stageid="f99d85f0-bee3-45f0-84cb-dfe7c5cc3833" name="End" type="End"><subsheetid>849bb75f-cb17-4e0a-8501-5fd66f31eb48</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="33542916-5fba-4e36-8b17-127cc0826bd4" name="Run Process" type="SubSheetInfo"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative>This method is used to execute a specific Blue Prism process asynchronously. 

NOTE: Only processes that have been published to Control Room may be started in this fashion.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="fcc08f76-3c58-49e7-9ed3-ac0494eb53f3" name="Note1" type="Note"><subsheetid>849bb75f-cb17-4e0a-8501-5fd66f31eb48</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="44fa7804-a7e8-4fe5-826b-2a591f42457b" name="Note2" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="1a925724-e679-4857-98f3-43ae8c36d0c1" name="End" type="End"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>660</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Session ID" stage="Session ID" /><output type="text" name="Output" stage="Output" /></outputs></stage><stage stageid="c5c1f51b-4db3-45d1-87e9-2e3e9e9449f2" name="Start" type="Start"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="UseSSO" narrative="Flag indicating whether to use single sign-on when calling AutomateC.exe." stage="Use SSO" /><input type="text" name="BPCredentialName" narrative="The name of a credential defined within Blue Prism Credential Manager to use if not using SSO." stage="Credential Name" /><input type="text" name="ProcessName" narrative="The name of the Blue Prism process to execute." stage="Process Name" /><input type="text" name="ProcessParameters" narrative="A string containing the required input parameters for the process. NOTE: See the user guide for information about how to format the input parameters." stage="Parameters" /><input type="text" name="CallbackInfo" narrative="A string containing callback information to use when notifying the originator that the Blue Prism process has completed." stage="CallbackInfo" /></inputs><onsuccess>66e81ebd-16a5-4cb1-b3d3-4e717b0bdbd0</onsuccess></stage><stage stageid="6c4f8fdf-9a0e-4f06-a3ec-86443138ded1" name="Arguments" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>405</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b5e76060-f9a4-498b-8950-f6e4714ee449" name="Call AutomateC" type="Code"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Application" expr="[AutomateC Path]" /><input type="text" name="Arguments" expr="[Arguments]" /><input type="text" name="Working Folder" expr="[Working Folder]" /><input type="number" name="Time Out" expr="[Time Out]" /></inputs><outputs><output type="text" name="Output" stage="Output" /></outputs><onsuccess>859b50f0-82f6-4308-9f15-690b8af605cf</onsuccess><code><![CDATA[System.Diagnostics.Process p = null;
System.Diagnostics.ProcessStartInfo s = null;
System.IO.StreamReader r = null;

if (Arguments.Trim().Length > 0)
  s = new System.Diagnostics.ProcessStartInfo(Application, Arguments);
else
  s = new System.Diagnostics.ProcessStartInfo(Application);

if (Working_Folder.Trim().Length > 0)
	s.WorkingDirectory = Working_Folder;

s.UseShellExecute = false;
s.RedirectStandardOutput = true;
s.CreateNoWindow = true;

p = new System.Diagnostics.Process();
p.StartInfo = s;
p.Start();
r = p.StandardOutput;
Output = r.ReadToEnd();

if ((Time_Out > 0) && (p.WaitForExit(Convert.ToInt32(1000*Time_Out)) == false))
	throw new Exception("Failed waiting for AutomateC.exe to end.");
]]></code></stage><stage stageid="4c25e86d-65c2-4185-8dac-8e928d4bf656" name="Output" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>240</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8ebb4715-aa2f-4099-80b9-7c1c8bb1753d" name="Time Out" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>375</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="0532f0c5-4ee7-4c19-a8fb-4127a6c2a051" name="Outputs" type="Block"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>150</displayy><displaywidth>180</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="008000" /></stage><stage stageid="48c1c6b9-cf23-496b-a32e-a6f185a3922b" name="Blue Prism User" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>465</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="be45199f-cfaa-4cdc-8c3e-cea8c979a118" name="Exists" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>315</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="88186b82-25ff-472c-831d-34aae0edc450" name="Exists?" type="Decision"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Exists]" /><ontrue>5a894b76-7e69-4ae2-9bcd-f2447dbf43a0</ontrue><onfalse>577f5915-f5e9-4889-a985-2630bf86c730</onfalse></stage><stage stageid="66e81ebd-16a5-4cb1-b3d3-4e717b0bdbd0" name="AutomateC exists" type="Action"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="File Name" narrative="The name of the file to check" expr="[AutomateC Path]" /></inputs><outputs><output type="flag" name="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>88186b82-25ff-472c-831d-34aae0edc450</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="577f5915-f5e9-4889-a985-2630bf86c730" name="64bit" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5a894b76-7e69-4ae2-9bcd-f2447dbf43a0</onsuccess><calculation expression="Replace([AutomateC Path], &quot; (x86)&quot;, &quot;&quot;)" stage="AutomateC Path" /></stage><stage stageid="5a894b76-7e69-4ae2-9bcd-f2447dbf43a0" name="Working Folder" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>9a9849a3-5620-4424-83a9-8d0371b2ee9a</onsuccess><calculation expression="Replace([AutomateC Path], &quot;\Automatec.exe&quot;, &quot;&quot;)" stage="Working Folder" /></stage><stage stageid="52826f18-4a1f-4715-a398-044ab5e04dad" name="Blue Prism Password" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>495</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="17caffb8-251e-427e-b186-6b5a5037dd8d" name="Build Argument List w/o SSO" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b5e76060-f9a4-498b-8950-f6e4714ee449</onsuccess><calculation expression="[Arguments] &amp; &quot; /user &quot; &amp; [Blue Prism User] &amp; &quot; &quot; &amp; [Blue Prism Password]" stage="Arguments" /></stage><stage stageid="6e59901d-5612-4611-b245-b339b93f404c" name="Use SSO" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="58865898-9ee9-4d65-9e19-88ef6238d649" name="Use SSO?" type="Decision"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Use SSO] = True" /><ontrue>034d05bc-8c98-4ca6-8389-c0078e684b66</ontrue><onfalse>8b0e033a-970b-4660-85e0-255b9ad9c7b5</onfalse></stage><stage stageid="034d05bc-8c98-4ca6-8389-c0078e684b66" name="Build Argument List w/ SSO" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>b5e76060-f9a4-498b-8950-f6e4714ee449</onsuccess><calculation expression="[Arguments] &amp; &quot; /sso&quot;" stage="Arguments" /></stage><stage stageid="a5a1262e-b6c1-4e37-bf25-fbd6ea4bbbc0" name="Inputs" type="Block"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>-45</displayy><displaywidth>180</displaywidth><displayheight>180</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e0a25e10-ec8a-44ed-b618-06b38d257c5e" name="Local Variables" type="Block"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>285</displayy><displaywidth>180</displaywidth><displayheight>330</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="af0d2315-0265-4bc7-a26e-f08b3b85f4be" name="Process Name" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8bfcbaf9-7187-467f-a1ea-7ed2ce5e4674" name="Parameters" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9a9849a3-5620-4424-83a9-8d0371b2ee9a" name="Include Start Params?" type="Decision"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Len(Trim([Parameters])) &gt; 0" /><ontrue>2f35948b-7cd0-49d8-b29c-e34f12c48c40</ontrue><onfalse>37d51386-686b-4897-991b-c725a1e5f549</onfalse></stage><stage stageid="dfcf4585-0fbd-4991-a151-6033bffee05f" name="Build w/ STARTP Flag" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>58865898-9ee9-4d65-9e19-88ef6238d649</onsuccess><calculation expression="&quot;/run &quot; &amp; Chr(34) &amp; [Process Name] &amp; Chr(34) &amp; &quot; /startp &quot; &amp; Chr(34) &amp; [Parameters] &amp; Chr(34) &amp; &quot; /resource &quot; &amp; Chr(34) &amp; [Process Dispatcher Resource Pool] &amp; Chr(34)" stage="Arguments" /></stage><stage stageid="575a393d-e116-45a1-9ee7-1b3cf43903a1" name="Build w/o STARTP Flag" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>58865898-9ee9-4d65-9e19-88ef6238d649</onsuccess><calculation expression="&quot;/run &quot; &amp; Chr(34) &amp; [Process Name] &amp; Chr(34) &amp; &quot; /resource &quot; &amp; Chr(34) &amp; [Process Dispatcher Resource Pool] &amp; Chr(34)" stage="Arguments" /></stage><stage stageid="9fe992b6-d86c-47de-8e81-43453b0ff79a" name="Success" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="2d45f3ca-c80f-4ba0-971c-86e9ec363d97" name="Dispatch Process" type="Block"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>345</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FF6600" /></stage><stage stageid="9349db6d-e089-4213-9080-b8e945b37c55" name="Process Exception" type="Recover"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>351f8e5d-29cf-4237-b213-8bb1cb6ad6c0</onsuccess></stage><stage stageid="e14ed371-d35f-4c7c-9a58-763c7d6cb5f3" name="Resume1" type="Resume"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>3c3803e7-db18-44ea-bfef-9121d471b016</onsuccess></stage><stage stageid="351f8e5d-29cf-4237-b213-8bb1cb6ad6c0" name="Get Exception Message" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>240</displayx><displayy>375</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e14ed371-d35f-4c7c-9a58-763c7d6cb5f3</onsuccess><calculation expression="ExceptionDetail()" stage="Output" /></stage><stage stageid="859b50f0-82f6-4308-9f15-690b8af605cf" name="Success?" type="Decision"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>435</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="StartsWith(Upper([Output]), &quot;STARTED PROCESS&quot;)" /><ontrue>e728d5a9-63da-4cd1-acd8-1da00b8efaf1</ontrue><onfalse>e44c518b-ae89-495e-9016-5a3beb0a0c60</onfalse></stage><stage stageid="e44c518b-ae89-495e-9016-5a3beb0a0c60" name="Set Failure" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>68c79482-f9ac-4839-86c9-779cea0dd845</onsuccess><calculation expression="False" stage="Success" /></stage><stage stageid="e728d5a9-63da-4cd1-acd8-1da00b8efaf1" name="Set Success" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>6140fd87-b36d-4c32-9e2e-b585b39d4996</onsuccess><calculation expression="True" stage="Success" /></stage><stage stageid="674139e5-f057-4dda-a2cd-dd41bb05553d" name="Session ID" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6140fd87-b36d-4c32-9e2e-b585b39d4996" name="Get Session ID" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>525</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4769518e-4035-4525-8225-974444f9841a</onsuccess><calculation expression="Mid([Output], InStr([Output], &quot;Session:&quot;) + 8, 36)" stage="Session ID" /></stage><stage stageid="3c3803e7-db18-44ea-bfef-9121d471b016" name="Set Failure" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>480</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>8bd17585-f9af-4a4d-8dfa-06ec89111e69</onsuccess><calculation expression="False" stage="Success" /></stage><stage stageid="091bb2de-9603-4cad-a47a-a5a196f25889" name="Credential Name" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8b0e033a-970b-4660-85e0-255b9ad9c7b5" name="Get User Credentials" type="Action"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit onsuccess="true" /><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><displayx>210</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Blue Prism Password" /><output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Blue Prism User" /><output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" /><output type="text" name="Status" friendlyname="Status" narrative="The status" stage="Status" /></outputs><onsuccess>17caffb8-251e-427e-b186-6b5a5037dd8d</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="652c7bcf-a5f9-47dd-8752-fb14bb2713d1" name="Status" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>525</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5bd0dcd8-83e7-4d96-ae3d-4702b1acdf0f" name="Get Credentials" type="Block"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>210</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="33CCCC" /></stage><stage stageid="ae75a8f6-b857-43a3-a720-e0c931a5393c" name="Credential Exception" type="Recover"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>285</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>e7a695a2-a935-4a9a-89c3-f9aa44cc2ac4</onsuccess></stage><stage stageid="e7a695a2-a935-4a9a-89c3-f9aa44cc2ac4" name="Get Exception Message" type="Calculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5e1a21dd-2c96-49e4-bf1d-6b441aa7f04f</onsuccess><calculation expression="ExceptionDetail()" stage="Output" /></stage><stage stageid="5e1a21dd-2c96-49e4-bf1d-6b441aa7f04f" name="Resume2" type="Resume"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5e546e1c-4712-4391-bb5a-ac50f749fbc5</onsuccess></stage><stage stageid="5e546e1c-4712-4391-bb5a-ac50f749fbc5" name="Anchor1" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>480</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>3c3803e7-db18-44ea-bfef-9121d471b016</onsuccess></stage><stage stageid="1ab23cb9-5aeb-4666-b3d3-6ce9c2759ae9" name="Add to Queue" type="Action"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit onsuccess="true" /><narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative><displayx>120</displayx><displayy>615</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Work Queue Name]" /><input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dispatched Process]" /><input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" /><input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" /><input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="" /><input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" /></inputs><outputs><output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="" /></outputs><onsuccess>1a925724-e679-4857-98f3-43ae8c36d0c1</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" /></stage><stage stageid="bcff031e-2760-42b0-b282-d3a009753059" name="Dispatched Process" type="Collection"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>555</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="SessionID" type="text" description="The unique session ID of the process that was launched." /><field name="ProcessName" type="text" description="The name of the process." /><field name="CallbackInfo" type="text" description="A string containing information to be used to notify the originator when the Blue Prism process has completed." /></collectioninfo><initialvalue><singlerow /><row><field name="SessionID" type="text" value="" /><field name="ProcessName" type="text" value="" /><field name="CallbackInfo" type="text" value="" /></row></initialvalue></stage><stage stageid="4769518e-4035-4525-8225-974444f9841a" name="Add to Collection" type="MultipleCalculation"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>570</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1ab23cb9-5aeb-4666-b3d3-6ce9c2759ae9</onsuccess><steps><calculation expression="[Session ID]" stage="Dispatched Process.SessionID" /><calculation expression="[Process Name]" stage="Dispatched Process.ProcessName" /><calculation expression="[CallbackInfo]" stage="Dispatched Process.CallbackInfo" /></steps></stage><stage stageid="9f4b816a-22ee-4db0-983d-64c168af801e" name="Work Queue Name" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>585</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Dispatched Processes</initialvalue><private /><alwaysinit /></stage><stage stageid="68c79482-f9ac-4839-86c9-779cea0dd845" name="Anchor2" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>660</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1a925724-e679-4857-98f3-43ae8c36d0c1</onsuccess></stage><stage stageid="8bd17585-f9af-4a4d-8dfa-06ec89111e69" name="Anchor3" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>660</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>1a925724-e679-4857-98f3-43ae8c36d0c1</onsuccess></stage><stage stageid="8f8e17b2-cf8f-4ecd-9a06-5d978021494f" name="Get Process Status" type="SubSheetInfo"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><narrative>This method is used to check the status of a process that was dispatched via this VBO.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="54a8cad2-2150-4788-8799-cc2434004833" name="Start" type="Start"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><preconditions><condition narrative="You must provide a valid session ID." /></preconditions><narrative></narrative><displayx>75</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SessionID" narrative="The unique ID of a process session." stage="Session ID" /><input type="flag" name="UseSSO" narrative="A flag indicating whether single sign-on should be used." stage="Use SSO" /><input type="text" name="Credential Name" narrative="The name of a credential within the Blue Prism Credential Manager to use if not using SSO." stage="Credential Name" /></inputs><onsuccess>6a2eaf64-f9a9-492c-b178-78a38107f36f</onsuccess></stage><stage stageid="3ceb862b-ec9d-4893-9fa4-dfbaf00157a5" name="Session ID" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><narrative>The unique identifier of a process session within Blue Prism.</narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ee8e7008-12b9-48ce-b030-3fbb70b3787d" name="Input" type="Block"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>-45</displayy><displaywidth>180</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f1018247-fc14-4973-96b9-1fcfdccf4184" name="Process Status" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a845c0bc-c854-40c3-9b81-d811edd133c6" name="Output" type="Block"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>90</displayy><displaywidth>180</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="CCFFCC" /></stage><stage stageid="1cda69a0-3b04-4105-b807-157d6d3af56f" name="Credential Name" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative>The name of a credential defined in BLue Prism Credential Manager with sufficient permission to execute a call to AutomateC.exe.</narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a61a68f6-5f5a-4714-a2be-1037b3fa9689" name="Use SSO" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative>A flag indicating whether to use single sign-on for authentication of the AutomateC.exe call.</narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="92543e45-d063-4b1e-84cb-369499882e2e" name="End" type="End"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>450</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Process Status" stage="Process Status" /><output type="text" name="Output" stage="Output" /></outputs></stage><stage stageid="9855fc1e-f41e-4c44-ae59-80f1f4ef2ea2" name="Get Process Status" type="Code"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Application" expr="[AutomateC Path]" /><input type="text" name="Arguments" expr="[Arguments]" /><input type="text" name="Working Folder" expr="[Working Folder]" /><input type="number" name="Time Out" expr="[Time Out]" /></inputs><outputs><output type="text" name="Output" stage="Output" /></outputs><onsuccess>687207bb-491c-4f93-b316-fdaa091870d9</onsuccess><code><![CDATA[System.Diagnostics.Process p = null;
System.Diagnostics.ProcessStartInfo s = null;
System.IO.StreamReader r = null;

if (Arguments.Trim().Length > 0)
  s = new System.Diagnostics.ProcessStartInfo(Application, Arguments);
else
  s = new System.Diagnostics.ProcessStartInfo(Application);

if (Working_Folder.Trim().Length > 0)
	s.WorkingDirectory = Working_Folder;

s.UseShellExecute = false;
s.RedirectStandardOutput = true;
s.CreateNoWindow = true;

p = new System.Diagnostics.Process();
p.StartInfo = s;
p.Start();
r = p.StandardOutput;
Output = r.ReadToEnd();

if ((Time_Out > 0) && (p.WaitForExit(Convert.ToInt32(1000*Time_Out)) == false))
	throw new Exception("Failed waiting for AutomateC.exe to end.");
]]></code></stage><stage stageid="324845fa-ab33-4a08-aafc-349db70127a8" name="Exists?" type="Decision"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Exists]" /><ontrue>d37e03e2-5301-49f4-bd1f-42b52fb22683</ontrue><onfalse>e3312206-2c67-4d24-b497-8e779883823c</onfalse></stage><stage stageid="11af8119-48b1-4943-b0a4-8069659df756" name="AutomateC exists" type="Action"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="File Name" narrative="The name of the file to check" expr="[AutomateC Path]" /></inputs><outputs><output type="flag" name="Exists" narrative="True if the file exists" stage="Exists" /></outputs><onsuccess>324845fa-ab33-4a08-aafc-349db70127a8</onsuccess><resource object="Utility - File Management" action="File Exists" /></stage><stage stageid="e3312206-2c67-4d24-b497-8e779883823c" name="64bit" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>d37e03e2-5301-49f4-bd1f-42b52fb22683</onsuccess><calculation expression="Replace([AutomateC Path], &quot; (x86)&quot;, &quot;&quot;)" stage="AutomateC Path" /></stage><stage stageid="d37e03e2-5301-49f4-bd1f-42b52fb22683" name="Working Folder" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>6182ae5d-480d-46a2-a0d6-51feb8d9ff0e</onsuccess><calculation expression="Replace([AutomateC Path], &quot;\Automatec.exe&quot;, &quot;&quot;)" stage="Working Folder" /></stage><stage stageid="861914df-f2de-4270-9414-5b9d8a1187e7" name="Build Argument List w/o SSO" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>9855fc1e-f41e-4c44-ae59-80f1f4ef2ea2</onsuccess><calculation expression="[Arguments] &amp; &quot; /user &quot; &amp; [Blue Prism User] &amp; &quot; &quot; &amp; [Blue Prism Password] &amp; &quot; /status &quot; &amp; [Session ID]" stage="Arguments" /></stage><stage stageid="6182ae5d-480d-46a2-a0d6-51feb8d9ff0e" name="Use SSO?" type="Decision"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Use SSO] = True" /><ontrue>d6a69f28-5c61-4603-941a-f7393d29e4f2</ontrue><onfalse>c480c0fb-349c-4743-aa34-3e384a03ea50</onfalse></stage><stage stageid="d6a69f28-5c61-4603-941a-f7393d29e4f2" name="Build Argument List w/ SSO" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>9855fc1e-f41e-4c44-ae59-80f1f4ef2ea2</onsuccess><calculation expression="[Arguments] &amp; &quot; /sso &quot; &amp; &quot;/status &quot; &amp; [Session ID] " stage="Arguments" /></stage><stage stageid="b62d5fd9-4361-446e-8cd5-82dc634690fe" name="Get Process Status" type="Block"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>225</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FF6600" /></stage><stage stageid="44764267-3d16-47d0-8cbd-a4bfe050cdf5" name="Get Status Exception" type="Recover"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>844b5e67-0c1c-4674-9d7f-885a580e6f09</onsuccess></stage><stage stageid="7674707a-f106-4e0b-8850-831087a07227" name="Resume1" type="Resume"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>eaf6cd7d-bfa2-4228-95de-f44461d701c2</onsuccess></stage><stage stageid="844b5e67-0c1c-4674-9d7f-885a580e6f09" name="Get Exception Message" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>240</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>7674707a-f106-4e0b-8850-831087a07227</onsuccess><calculation expression="ExceptionDetail()" stage="Output" /></stage><stage stageid="687207bb-491c-4f93-b316-fdaa091870d9" name="Error?" type="Decision"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>315</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="StartsWith(Upper([Output]), &quot;ERROR:&quot;) OR InStr(Upper([Output]), &quot;STATUS:&quot;) = 0" /><ontrue>b08f3f00-51b6-41a4-a8a6-2b961f1cafc4</ontrue><onfalse>f1bc4213-f149-42c7-8fc1-73545626377a</onfalse></stage><stage stageid="b08f3f00-51b6-41a4-a8a6-2b961f1cafc4" name="Set Failure" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>360</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4380fc4e-866c-4505-baec-764161107eb5</onsuccess><calculation expression="False" stage="Success" /></stage><stage stageid="f1bc4213-f149-42c7-8fc1-73545626377a" name="Set Success" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>360</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>7b2de0af-160f-4e3a-9f22-46f41e2f4f5d</onsuccess><calculation expression="True" stage="Success" /></stage><stage stageid="7b2de0af-160f-4e3a-9f22-46f41e2f4f5d" name="Get Status" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>405</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>92543e45-d063-4b1e-84cb-369499882e2e</onsuccess><calculation expression="Mid([Output], InStr([Output], &quot;Status:&quot;) + 7, (Len([Output]) - InStr([Output], &quot;Status:&quot;) + 7))" stage="Process Status" /></stage><stage stageid="eaf6cd7d-bfa2-4228-95de-f44461d701c2" name="Set Failure" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>360</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>7b203f03-a85a-4062-9cb3-5e7e872c831a</onsuccess><calculation expression="False" stage="Success" /></stage><stage stageid="c480c0fb-349c-4743-aa34-3e384a03ea50" name="Get User Credentials" type="Action"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit onsuccess="true" /><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><displayx>210</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Blue Prism Password" /><output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Blue Prism User" /><output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" /><output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" /></outputs><onsuccess>861914df-f2de-4270-9414-5b9d8a1187e7</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="67bbd3ec-efbd-4e35-84ab-6ebe71c43ab1" name="Get Credentials" type="Block"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>105</displayy><displaywidth>165</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="33CCCC" /></stage><stage stageid="b5277e44-039d-4ae0-8cbb-0c6437106f5a" name="Credential Exception" type="Recover"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>285</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>bc27ec80-4c29-48e3-bda3-899d5ffe3dc4</onsuccess></stage><stage stageid="bc27ec80-4c29-48e3-bda3-899d5ffe3dc4" name="Get Exception Message" type="Calculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>fd3ec418-69cf-4519-a8b3-49db4a87c970</onsuccess><calculation expression="ExceptionDetail()" stage="Output" /></stage><stage stageid="fd3ec418-69cf-4519-a8b3-49db4a87c970" name="Resume2" type="Resume"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>96f8402c-3e54-4ac2-a8b5-5a75bf228675</onsuccess></stage><stage stageid="96f8402c-3e54-4ac2-a8b5-5a75bf228675" name="Anchor1" type="Anchor"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>375</displayx><displayy>360</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>eaf6cd7d-bfa2-4228-95de-f44461d701c2</onsuccess></stage><stage stageid="4380fc4e-866c-4505-baec-764161107eb5" name="Anchor2" type="Anchor"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>450</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>92543e45-d063-4b1e-84cb-369499882e2e</onsuccess></stage><stage stageid="7b203f03-a85a-4062-9cb3-5e7e872c831a" name="Anchor3" type="Anchor"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>315</displayx><displayy>450</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>92543e45-d063-4b1e-84cb-369499882e2e</onsuccess></stage><stage stageid="93894c63-e376-4a73-8034-7144f3c4d4cf" name="Arguments" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>345</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="456bdb48-4005-4252-8ca4-66ca1cfdd75a" name="Working Folder" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>285</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7361dca6-15e2-433b-9ea0-50c804a7cfda" name="Time Out" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>315</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="8f2aba4d-bab3-475b-a7ca-2674a32f3b60" name="Blue Prism User" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>375</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a85450ce-4ffc-4304-9893-e20b7c18cfff" name="Exists" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="92c24f28-423e-4a56-b6e6-4a1a030a81e7" name="Blue Prism Password" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>405</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="e6499612-c58a-4f06-a867-88e7ce8da119" name="Local Variables" type="Block"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>225</displayy><displaywidth>180</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF99" /></stage><stage stageid="6a2eaf64-f9a9-492c-b178-78a38107f36f" name="Session ID Provided?" type="Decision"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Len(Trim([Session ID])) &gt; 0" /><ontrue>11af8119-48b1-4943-b0a4-8069659df756</ontrue><onfalse>95f1d4b1-248e-4d83-a596-da81c5daff76</onfalse></stage><stage stageid="c92fa831-5688-435e-8991-8e93fb68b1a5" name="Success" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="51cefb32-bb6e-47d8-b299-bf662fec5ced" name="Output" type="Data"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="95f1d4b1-248e-4d83-a596-da81c5daff76" name="Set Failure &amp; Message" type="MultipleCalculation"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>16f3f5fe-c6db-4fe3-b12e-f0beba2b21e4</onsuccess><steps><calculation expression="False" stage="Success" /><calculation expression="&quot;Error! You must provide a Session ID.&quot;" stage="Output" /></steps></stage><stage stageid="16f3f5fe-c6db-4fe3-b12e-f0beba2b21e4" name="Anchor4" type="Anchor"><subsheetid>7e3852b7-ac06-4635-a81b-df7ccf5d8f0f</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>450</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4380fc4e-866c-4505-baec-764161107eb5</onsuccess></stage><stage stageid="b5927d21-d303-4458-b977-e0d1d8c2e806" name="CallbackInfo" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c14bf9e1-580d-4296-bd8e-3c79c006829d" name="AutomateC Path" type="Data"><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">C:\Program Files (x86)\Blue Prism Limited\Blue Prism Automate\Automatec.exe</initialvalue><alwaysinit /></stage><stage stageid="83a34a9e-7545-4319-a194-f6aceab0c123" name="Global Values" type="Block"><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-120</displayy><displaywidth>180</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="dea779c2-f894-4c59-80e8-1ad076a3583d" name="Working Folder" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>345</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="78453551-ddea-4aac-bcfb-205558364ff0" name="Note3" type="Note"><loginhibit /><narrative>AutomateC Path

NOTE: If your company standard is to install Blue Prism on a drive other than C: you will need to edit the path information in the global value section above.</narrative><displayx>165</displayx><displayy>0</displayy><displaywidth>210</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="0000FF" /></stage><stage stageid="043f39dd-1961-41f1-9506-e2efb6fd3afe" name="XML Formatted?" type="Decision"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="InStr([Parameters], &quot;&lt;inputs&gt;&quot;) &gt; 0" /><ontrue>dfcf4585-0fbd-4991-a151-6033bffee05f</ontrue><onfalse>8b87676a-6583-4e20-b1cb-ebaaeb14fe83</onfalse></stage><stage stageid="2f35948b-7cd0-49d8-b29c-e34f12c48c40" name="Anchor5" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>d959ccb5-6eb9-466d-a088-c5649f80137d</onsuccess></stage><stage stageid="37d51386-686b-4897-991b-c725a1e5f549" name="Anchor6" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>15</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>575a393d-e116-45a1-9ee7-1b3cf43903a1</onsuccess></stage><stage stageid="d363bbaf-b727-4f44-b2c6-11dbabd9996d" name="Convert JSON to XML" type="Code"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-45</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="input" expr="[Parameters]" /></inputs><outputs><output type="text" name="output" stage="Parameters" /></outputs><onsuccess>93186af1-7a81-4f4a-9173-41421dbfc485</onsuccess><code><![CDATA[// Convert the JSON-encoded input parameters to the necessary 
// XML format required by AutomateC.
XmlDocument doc = JsonConvert.DeserializeXmlNode(input);
output = doc.OuterXml;]]></code></stage><stage stageid="8b87676a-6583-4e20-b1cb-ebaaeb14fe83" name="Anchor7" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-45</displayx><displayy>105</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>d363bbaf-b727-4f44-b2c6-11dbabd9996d</onsuccess></stage><stage stageid="93186af1-7a81-4f4a-9173-41421dbfc485" name="Anchor8" type="Anchor"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-45</displayx><displayy>195</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>dfcf4585-0fbd-4991-a151-6033bffee05f</onsuccess></stage><stage stageid="81435203-ace9-4d4b-8daf-19ba620d32bd" name="Process Dispatcher Resource Pool" type="Data"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>435</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="d959ccb5-6eb9-466d-a088-c5649f80137d" name="Decode Parameters" type="Code"><subsheetid>fbe99cb3-70e0-4179-8ec5-57b7d41d301c</subsheetid><loginhibit /><narrative>If the parameters data was URL encoded by the calling platform, we will decode it before handing it off to AutomateC.</narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="EncodedParams" expr="[Parameters]" /></inputs><outputs><output type="text" name="DecodedParams" stage="Parameters" /></outputs><onsuccess>043f39dd-1961-41f1-9506-e2efb6fd3afe</onsuccess><code><![CDATA[// Should UrlDecode or HttpDecode be used?
if ((EncodedParams.Contains("%3c")) || (EncodedParams.Contains("%3C")))
	DecodedParams = WebUtility.UrlDecode(EncodedParams).Trim();
else if (EncodedParams.Contains("&lt;"))
	DecodedParams = WebUtility.HtmlDecode(EncodedParams).Trim();
else
	// Neither of our tests worked, so the input parameters were
	// likely not encoded.
	DecodedParams = EncodedParams;

]]></code></stage></process></object>
        <work-queue id="9" name="Dispatched Processes" key-field="SessionID" max-attempts="300" xmlns="http://www.blueprism.co.uk/product/work-queue" />
        <environment-variable id="Process Dispatcher Credential Name" name="Process Dispatcher Credential Name" type="text" value="Blue Prism" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>A credential, defined within Credential Manager, that will be used by the Process Dispatcher utility.</description>
        </environment-variable>
        <environment-variable id="Process Dispatcher Resource Pool" name="Process Dispatcher Resource Pool" type="text" value="DispatchedProcessPool" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>The name of the resource pool to use for executing dispatched processes.</description>
        </environment-variable>
        <environment-variable id="Queue: Dispatched Processes" name="Queue: Dispatched Processes" type="text" value="Dispatched Processes" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>A work queue use to track the sessions IDs and callback information for any processes executed via the Process Dispatcher utility.</description>
        </environment-variable>
        <process-group id="7d9738e5-d444-4216-b8b2-a76db8e08dcb" name="Process Dispatch Framework" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="102f1e61-4ecb-44be-bb03-ce074a2012f5" />
            </members>
        </process-group>
        <object-group id="c9a25bc0-449f-4fda-bcfb-352dfd5cb504" name="Process Dispatch Framework" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="66af8e92-09a0-4be0-8a98-5c493155875b" />
                <object id="0c6b4a32-34ee-4848-be38-7bc9196237ef" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>